# Parameters for ROSflight software-in-the-loop simulation

# Common Global Physical Parameters

mass: 2.0
linear_mu: 0.05
angular_mu: 0.0005
ground_effect: [-55.3516, 181.8265, -203.9874, 85.3735, -7.6619]

# Dynamics
num_rotors: 4
rotor_positions: [ 0.1926,  0.230, -0.0762,
                  -0.1907,  0.205, -0.0762,
                  -0.1907, -0.205, -0.0762,
                   0.1926, -0.230, -0.0762]

rotor_vector_normal: [-0.02674078,  0.0223925,  -0.99939157,
                       0.02553726,  0.02375588, -0.99939157,
                       0.02553726, -0.02375588, -0.99939157,
                      -0.02674078, -0.0223925,  -0.99939157]

rotor_rotation_directions: [-1, 1, -1, 1]
rotor_max_thrust: 14.961
rotor_F: [1.5e-5, -0.024451, 9.00225]
rotor_T: [2.22e-7,-3.51e-4,  0.12531]
rotor_tau_up: 0.2164
rotor_tau_down: 0.1644

# Provo, UT
ground_altitude: 1387
inclination: 1.14316156541
declination: 0.198584539676

# Sensor Noise Parameters (These are empirically-determined)
gyro_stdev: 0.005
gyro_bias_range: 0.005
gyro_bias_walk_stdev: 0.0

acc_stdev: 0.05
acc_bias_range: 0.01
acc_bias_walk_stdev: 0.0

baro_stdev: 0.1
baro_bias_range: 0.0
baro_bias_walk_stdev: 0.0

sonar_stdev: 0.1
sonar_min_range: 0.25
sonar_max_range: 6.0

mag_stdev: 0.02
mag_bias_range: 0.0
mag_bias_walk_stdev: 0.0

gps: {

noise_on: true,
rate: 10.0,
topic: gps/data,
north_stdev: 0.021,
east_stdev: 0.021,
alt_stdev: 0.040,
k_north: 0.0009090909, # 1/1100
k_east: 0.0009090909, # 1/1100
k_alt: 0.0009090909, # 1/1100
initial_latitude: 40.267320,
initial_longitude: -111.635629,
initial_altitude: 1387.0,
num_sats: 7

}

### Waypoints ###

waypoint_manager: {

waypoints:
 [[5, 5, -5, 0],
 [5, -5, -3, 0.78],
 [-5, -5, -5, 0],
 [-5, 5, -3, -0.78]],

threshold: 1,
cyle: True

}

### Controller Parameters

controller: {

kp_x: 0.5,
kp_y: 0.5,
kp_z: 0.8,
kv_x: 2.0,
kv_y: 2.0,
kv_z: 2.0,
kd_x: 0.0,
kd_y: 0.0,
kd_z: 0.0,

equilibrium_throttle: 0.545, # m*g/F_max

max_roll: 0.5,
max_pitch: 0.5,
max_yaw_rate: 0.785,
max_throttle: 0.85,
max_vel: 1.5,
}

### Estimator Parameters ###

mekf: {

p0: [0,  # PN
     0,  # PE
     0], # PD

q0: [1,  # QW
     0,  # QX
     0,  # QY
     0], # QZ

v0: [0,  # U
     0,  # V
     0], # W

bg0: [0,  # GX
      0,  # GY
      0], # GZ

ba0: [0,  # AX
      0,  # AY
      0], # AZ

mu0: 0.05, # MU

P0: [0.0000000001,  0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,  # dPN
     0.0000000001,  0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,  # dPE
     0.0000000001,  0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,  # dPD
     0.0000000001,  0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,  # dPHI
     0.0000000001,  0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,  # dTHETA
     0.0000000001,  0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,  # dPSI
     0.0000000001,  0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,  # dU
     0.0000000001,  0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,  # dV
     0.0000000001,  0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,  # dW
     0.0010000000,  0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,  # dGX
     0.0010000000,  0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,  # dGY
     0.0010000000,  0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,  # dGZ
     0.0010000000,  0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,  # dAX
     0.0010000000,  0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,  # dAY
     0.0010000000,  0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,  # dAZ
     0.0000000000],                                   # dMU

Qx: [0.0000000001,  0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,  # dPN
     0.0000000001,  0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,  # dPE
     0.0000000001,  0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,  # dPD
     0.0000000001,  0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,  # dPHI
     0.0000000001,  0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,  # dTHETA
     0.0000000001,  0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,  # dPSI
     0.0000000001,  0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,  # dU
     0.0000000001,  0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,  # dV
     0.0000000001,  0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,  # dW
     0.0000010000,  0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,  # dGX
     0.0000010000,  0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,  # dGY
     0.0000010000,  0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,  # dGZ
     0.0000010000,  0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,  # dAX
     0.0000010000,  0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,  # dAY
     0.0000010000,  0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,  # dAZ
     0.0000000000],                                   # dMU

Qu: [0.000025,  0,0,0,0,0,0,  # GYRO_X
     0.000025,  0,0,0,0,0,0,  # GYRO_Y
     0.000025,  0,0,0,0,0,0,  # GYRO_Z
     0.002500,  0,0,0,0,0,0,  # ACCEL_X
     0.002500,  0,0,0,0,0,0,  # ACCEL_Y
     0.002500],               # ACCEL_Z

Rsonar: 0.01, # SONAR VARIANCE

Rbaro: 0.01, # BAROMETER VARIANCE

Rmag: 0.004, # MAGNETOMETER VARIANCE

Rgps: [0.000441, 0,0, # PN
       0.000441],     # PE

declination: 0.198584539676  # MAGNETIC DECLINATION (PROVO, UT)

}
